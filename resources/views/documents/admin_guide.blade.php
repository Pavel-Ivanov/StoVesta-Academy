<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Инструкция администратора — Система документов</title>
    <style>
        html, body { margin:0; padding:0; background:#ffffff; color:#111111; font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
        .container { max-width: 900px; margin: 0 auto; padding: 24px; }
        h1, h2, h3 { line-height:1.25; margin: 24px 0 12px; }
        h1 { font-size: 28px; }
        h2 { font-size: 22px; border-bottom:1px solid #e5e7eb; padding-bottom:6px; }
        h3 { font-size: 18px; }
        p { margin: 10px 0; }
        ul { margin: 8px 0 16px 20px; }
        code { background:#f6f8fa; padding:2px 6px; border-radius:4px; }
        .toolbar { position: sticky; top: 0; background:#f9fafb; border-bottom:1px solid #e5e7eb; padding: 8px 12px; display:flex; gap:8px; align-items:center; z-index:10; }
        .toolbar .spacer { flex:1; }
        .btn { display:inline-block; padding:8px 12px; background:#111827; color:white; text-decoration:none; border-radius:6px; }
        .btn.secondary { background:#4b5563; }
        .muted { color: #555555; }
        .card { border:1px solid #e5e7eb; border-radius:8px; padding:12px 16px; background:white; margin: 16px 0; }
        @media print {
            .no-print { display:none !important; }
            .container { padding: 0 0; }
            h1 { margin-top: 0; }
        }
    </style>
</head>
<body>
<div class="toolbar no-print">
    <strong>Инструкция администратора — Система документов</strong>
    <div class="spacer"></div>
    <button class="btn" onclick="window.print()">Скачать PDF</button>
</div>

<div class="container">
    <h1>Инструкция администратора по работе с системой документов</h1>
    <p class="muted">Эта страница предназначена для администраторов и описывает полный цикл работы с документами: создание, редактирование, многостраничные документы, видимость по ролям, печать и скачивание.</p>

    <h2>1. Где находится управление документами</h2>
    <ul>
        <li>Откройте Панель администратора (Sadmin).</li>
        <li>В левом меню перейдите в группу «Справочники» → пункт «Документы».</li>
        <li>Откроется список всех документов с колонками «Название», «Тип», «Листов», «Видимость», «Изменён».</li>
    </ul>

    <h2>2. Создание документа</h2>
    <p>Нажмите «Создать». Заполните поля формы:</p>
    <ul>
        <li><strong>Название</strong> — заголовок документа.</li>
        <li><strong>Тип документа</strong> — выберите из списка (Сертификаты, Формы, Справочник). Используется для маршрутизации пунктов меню в панели студента.</li>
        <li><strong>Описание</strong> — необязательное текстовое поле.</li>
        <li><strong>Файл (один файл)</strong> — загрузите единый файл документа <em>или</em> оставьте пустым, если будете добавлять листы ниже.</li>
        <li><strong>Листы документа</strong> — репитер для многостраничных документов. На каждом листе:
            <ul>
                <li>Название листа (необязательно)</li>
                <li>Файл листа (обязательно)</li>
                <li>Порядок (меньше — раньше)</li>
            </ul>
        </li>
        <li><strong>Видимость (минимальная роль)</strong> — выберите <code>all</code> или конкретную роль (например, «Студент», «Преподаватель», «Администратор»). Документ увидят пользователи, у которых есть выбранная роль.</li>
    </ul>
    <div class="card">
        <strong>Важно:</strong> система не позволит сохранить пустой документ — должен быть загружен единый файл или добавлен хотя бы один лист.
    </div>

    <h2>3. Однофайловые и многостраничные документы</h2>
    <ul>
        <li><strong>Одиночный файл</strong>: используйте поле «Файл (один файл)».</li>
        <li><strong>Многостраничный документ</strong>: оставьте «Файл (один файл)» пустым и добавьте один или несколько листов в репитере «Листы документа».</li>
        <li><strong>Смешанный режим</strong>: допускается, но в пользовательской панели «Просмотр/Скачать» будут работать по первому листу; печать выведет все листы.</li>
        <li><strong>Колонка «Листов»</strong> показывает «1» для одиночного файла или одного листа, и фактическое число (2, 3, …) для многостраничных документов.</li>
    </ul>

    <h2>4. Видимость и доступ</h2>
    <ul>
        <li>Видимость определяет <em>минимальную</em> роль пользователя для доступа к документу.</li>
        <li><code>all</code> — документ доступен всем авторизованным пользователям панели студента.</li>
        <li>Конкретная роль — документ доступен только пользователям, у которых есть эта роль.</li>
        <li>В панели студента список документов фильтруется по типу и по видимости.</li>
    </ul>

    <h2>5. Действия со стороны пользователя</h2>
    <ul>
        <li><strong>Просмотр</strong> — открывает основной файл (или первый лист) в новой вкладке.</li>
        <li><strong>Скачать</strong> — скачивает основной файл (или первый лист).</li>
        <li><strong>Распечатать</strong> — печать всех листов документа через спецстраницу.</li>
        <li><strong>Скачать всё</strong> — загрузка всех листов в одном ZIP-архиве.</li>
    </ul>

    <h2>6. Редактирование и удаление</h2>
    <ul>
        <li>В списке документов доступны действия «Просмотр», «Редактировать», «Удалить».</li>
        <li>При редактировании действуют те же правила валидации: документ не может быть пустым (нужен файл или хотя бы один лист).</li>
    </ul>

    <h2>7. Печать и экспорт</h2>
    <ul>
        <li>Печать использует маршрут <code>/documents/{id}/print</code> и формирует печатную страницу с последовательностью всех листов.</li>
        <li>Экспорт «Скачать всё» формирует ZIP-архив с листами по порядку.</li>
        <li>Рекомендованный формат для печати — PDF. Для изображений/доков результат зависит от браузера.</li>
    </ul>

    <h2>8. Советы и лучшие практики</h2>
    <ul>
        <li>Давайте документам и листам понятные названия для простоты поиска.</li>
        <li>Используйте «Порядок» для корректной последовательности печати.</li>
        <li>Назначайте минимально необходимую «Видимость», чтобы не скрывать документ зря.</li>
        <li>Для крупных документов рассмотрите объединение листов в один PDF во внешнем инструменте до загрузки.</li>
    </ul>

    <h2>9. Частые вопросы</h2>
    <ul>
        <li><strong>Документ не отображается у пользователей:</strong> проверьте «Тип» и «Видимость» (роль пользователя должна совпадать или быть <code>all</code>).</li>
        <li><strong>Кнопка «Просмотр» неактивна:</strong> у документа отсутствует файл и листы — добавьте хотя бы один из вариантов.</li>
        <li><strong>Нужно отдать все листы одним файлом:</strong> используйте «Скачать всё (ZIP)». Для объединённого PDF потребуется внешняя библиотека — обратитесь к разработчику.</li>
    </ul>

    <p class="muted">Версия инструкции: {{ now()->format('Y-m-d') }}</p>
</div>

<script>
    // Ничего, только кнопка печати сверху
</script>
</body>
</html>
